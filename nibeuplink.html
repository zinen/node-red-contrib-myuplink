<script type="text/javascript">
    RED.nodes.registerType('nibeuplink-config',{
        category: 'config',
        defaults: {
            name: {value:""},
            clientId: {value:"", required: true },
            clientSecret: {value:"", required: true },
            systemId: {Value:"", required: true },
            authCode: {value:""},
        },
        label: function() {
            let defaultName="nibe uplink config"
            if (!this.authCode) {
                defaultName += " (missing auth code)"
            }
            return this.name || defaultName;
        }
    });
</script>

<script type="text/html" data-template-name="nibeuplink-config">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-user"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Optional name">
    </div>
    <div class="form-tips"><p>To get a client login you need to register an application at <a href="https://api.nibeuplink.com/" target="_blank">api.nibeuplink.com</a></p>
    <p>Give your application a name and description. Callback URL needs to be http://z0mt3c.github.io/nibe.html</p></div>
    <div class="form-row">
        <label for="node-config-input-clientId"><i class="fa fa-user"></i> Client Identifier</label>
        <input type="text" id="node-config-input-clientId" placeholder="jlk12341hasd2224">
    </div>
    <div class="form-row">
        <label for="node-config-input-clientSecret"><i class="fa fa-key"></i> Client secret</label>
        <input type="password" id="node-config-input-clientSecret" placeholder="asdagf34263st4erfs213qas" autocomplete="off">
    </div>
    <div class="form-tips"><p>Get your system id at nibeuplink.com enter status page of unit and find system id in URL like X inside https://nibeuplink.com/System/x/Status/Overview
    </p></div>
    <div class="form-row">
        <label for="node-config-input-systemId"><i class="fa fa-globe"></i> System ID</label>
        <input type="text" id="node-config-input-systemId" placeholder="64087" autocomplete="off">
    </div>
    <div class="form-tips"><p>Leave auth code empty at first run go get the URL needed to authenticate. You will be directed from api.nibeuplink.com back to the defined Callback URL mentioned above. The Callback URL will reveal your auth code
        </p></div>
    <div class="form-row">
        <label for="node-config-input-authCode"><i class="fa fa-key"></i> authCode</label>
        <input type="password" id="node-config-input-authCode" placeholder="should be empty at first run" autocomplete="off">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('nibeuplink',{
        category: 'request',
        color: '#a6bbcf',
        defaults: {
            name: {value:""},
            server: {type:"nibeuplink-config", required:true},
        },
        inputs:1,
        outputs:1,
        icon: "white-globe.png",
        label: function() {
            return this.name ||"nibe uplink";
        }
    });
</script>


<script type="text/html" data-template-name="nibeuplink">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-user"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Optional name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-globe"></i> Config</label>
        <input type="text" id="node-input-server" placeholder="Optional name">
    </div>
</script>

<script type="text/html" data-help-name="nibeuplink">
    <p>A Node-Red Node for collecting data from nibe uplink.</p>
    <h3>Inputs</h3>
    <p> Any </p>
    <h3>Output</h3>
    <p> Return object with raw API data</p>
</script>